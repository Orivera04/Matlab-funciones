% Script f04_05.m; data and curve fits for F4H thrust vs. Mach 
% number M and altitude h (kft); fit made using 4th order poly-
% nomials in M and h (modification of Hedrick 1972);
%                                                  4/94, 4/2/02 
%
% Data:
M=[0:.2:1.8]; h=[0:5:30 40 50 70];     
%
T=NaN*ones(10);
T(1,1)=    [24.2                                            ];
T(2,1:7)=  [28.0 24.6 21.1 18.1 15.2 12.8 10.7              ];
T(3,1:9)=  [28.3 25.2 21.9 18.7 15.9 13.4 11.2  7.3  4.4    ];
T(4,1:9)=  [30.8 27.2 23.8 20.5 17.3 14.7 12.3  8.1  4.9    ];
T(5,:)=    [34.5 30.3 26.6 23.2 19.8 16.8 14.1  9.4  5.6 1.1];
T(6,:)=    [37.9 34.3 30.4 26.8 23.3 19.8 16.8 11.2  6.8 1.4];
T(7,:)=    [36.1 38.0 34.9 31.3 27.3 23.6 20.1 13.4  8.3 1.7];
T(8,2:10)= [     36.6 38.5 36.1 31.6 28.1 24.2 16.2 10.0 2.2];
T(9,4:10)= [               38.7 35.7 32.0 28.1 19.3 11.9 2.9];
T(10,6:10)=[                         34.6 31.1 21.7 13.3 3.1];
%
T=T/34;                        % Thrust in units of W = 34 klb
%
figure(1);  clf; hold on; 
plot(M,T(:,1),'x'); plot(M,T(:,2),'o'); plot(M,T(:,3),'+');
plot(M,T(:,4),'x'); plot(M,T(:,5),'o'); plot(M,T(:,6),'+'); 
plot(M,T(:,7),'x'); plot(M,T(:,8),'o'); plot(M,T(:,9),'+'); 
plot(M,T(:,10),'x'); 
xlabel('Mach Number'); ylabel('Thrust/Weight')
%
% Data fit:
Q=[3.0210e+001 -6.6820e-001 -6.8770e+000  1.9510e+000 -1.5120e-001; ...
  -3.3800e+001  3.3470e+000  1.8130e+001 -5.8650e+000  4.7570e-001; ...
   1.0080e+002 -7.7560e+001  5.4410e+000  2.8640e+000 -3.3550e-001; ...
  -7.8990e+001  1.0140e+002 -3.0280e+001  3.2360e+000 -1.0890e-001; ...
   1.8740e+001 -3.1600e+001  1.2040e+001 -1.7850e+000  9.4170e-002];
M=[0:.05:1.8];   h=[0:5:30 40 50 70]/10;
i=1; for j=1:25,
  T(i,j)=[1 M(j) M(j)^2 M(j)^3 M(j)^4]*Q*[1 h(i) h(i)^2 h(i)^3 h(i)^4]';
  end; plot(M(1:25),T(i,1:25)/34); hold on
for i=2:3, for j=5:29,
  T(i,j)=[1 M(j) M(j)^2 M(j)^3 M(j)^4]*Q*[1 h(i) h(i)^2 h(i)^3 h(i)^4]';
  end; end; plot(M(5:29),T(2:3,5:29)/34); 
for i=4:5, for j=5:33,
  T(i,j)=[1 M(j) M(j)^2 M(j)^3 M(j)^4]*Q*[1 h(i) h(i)^2 h(i)^3 h(i)^4]';
  end; end; plot(M(5:33),T(4:5,5:33)/34); 
for i=6:7, for j=5:37,
  T(i,j)=[1 M(j) M(j)^2 M(j)^3 M(j)^4]*Q*[1 h(i) h(i)^2 h(i)^3 h(i)^4]';
  end; end; plot(M(5:37),T(6:7,5:37)/34); 
for i=8:9, for j=9:37,
  T(i,j)=[1 M(j) M(j)^2 M(j)^3 M(j)^4]*Q*[1 h(i) h(i)^2 h(i)^3 h(i)^4]';
  end; end; plot(M(9:37),T(8:9,9:37)/34);
i=10; for j=17:37,
  T(i,j)=[1 M(j) M(j)^2 M(j)^3 M(j)^4]*Q*[1 h(i) h(i)^2 h(i)^3 h(i)^4]';
  end; plot(M(17:37),T(10,17:37)/34); 
hold off; grid;  axis([0 2 0 1.2])
text(.24,.9,'h = 0 kft'); text(.55,.84,'5'); text(.61,.76,'10');
text(.62,.66,'15'); text(.63,.57,'20'); text(.66,.50,'25');
text(.72,.44,'30'); text(.84,.35,'40');
text(1.06,.28,'50'); text(1.22,.1,'70');
%print -deps2 \book_do\figures\f04_05