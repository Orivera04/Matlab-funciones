function varargout = yetAnotherGUI

close all

hfigure = figure(...
    'Units','characters',...
    'Color',[0.250980392156863 0 0.501960784313725],...
    'MenuBar','none',...
    'Name','Molly''s EZ Grapher',...
    'NumberTitle','off',...
    'Position',[10.8 9.9230769230769 160.6 41.5384615384615]);

hequationPanel = uipanel(...
    'Parent',hfigure,...
    'Units','characters',...
    'Title','',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'Position',[7.8 19.8461538461538 44.2 18.5384615384615]);


henterEquationText = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[1.8 16.0769230769231 36.2 1.61538461538462],...
    'String','Enter your equation below:',...
    'Style','text');

henterEquationEditBox = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[1.2 13.8461538461539 40.2 2.23076923076923],...
    'String','x.^2-4',...
    'Style','edit');

henterDomainText = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[1.6 10.8461538461538 40.2 1.61538461538462],...
    'String','Enter domain below:',...
    'Style','text');

hxMinText = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[1.6 9.07692307692308 8.4 1.38461538461538],...
    'String','xmin =',...
    'Style','text');

hxMinEditBox = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[11.8 9 6 1.61538461538462],...
    'String','-5',...
    'Style','edit');

hxMaxText = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[23 8.92307692307692 8.4 1.61538461538462],...
    'String','xmax =',...
    'Style','text');

hxMaxEditBox = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[34.4 9.07692307692307 6.4 1.61538461538462],...
    'String','5',...
    'Style','edit');

hnumberOfPointsText = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[2.2 5.46153846153846 21.8 2],...
    'String','Number of points:',...
    'Style','text');

hnumberOfPointsEditBox = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[23.8 5.84615384615384 16.2 1.61538461538462],...
    'String','100',...
    'Style','edit');

hgraphPushButton = uicontrol(...
    'Parent',hequationPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[23.8 1.38461538461538 16.2 1.69230769230769],...
    'String','Graph it!',...
    'Callback',@graphPushButton_Callback);

hfindPanel = uipanel(...
    'Parent',hfigure,...
    'Units','characters',...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Title','',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'Position',[7.8 3 44.2 13.9230769230769]);

hfindText = uicontrol(...
    'Parent',hfindPanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[3.8 10.6923076923077 16.2 2.38461538461538],...
    'String','Find:',...
    'Style','text');

hrootsPushButton = uicontrol(...
    'Parent',hfindPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[3.8 9.15384615384616 16.2 2],...
    'String','  Roots',...
    'Callback',@rootsPushButton_Callback);

hlocalMinPushButton = uicontrol(...
    'Parent',hfindPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[3.8 6.46153846153846 24.2 2],...
    'String','  Local minimum',...
    'Callback',@localMinPushButton_Callback);

hlocalMaxPushButton = uicontrol(...
    'Parent',hfindPanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[3.8 3.53846153846154 24.2 2],...
    'String','  Local maximum',...
    'Callback',@localMaxPushButton_Callback);

hequationGraph = axes(...
    'Parent',hfigure,...
    'Units','characters',...
    'Position',[67.8 12.1538461538462 84.2 26.2307692307692],...
    'Color',[0.976470588235294 0.992156862745098 0.635294117647059]);

hlineStylePanel = uipanel(...
    'Parent',hfigure,...
    'Units','characters',...
    'Title','',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'Position',[67.8 2.92307692307692 84.2 6.23076923076923]);

hcolorPopup = uicontrol(...
    'Parent',hlineStylePanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[3.8 2.30769230769231 24.4 1.76923076923077],...
    'String',{  'Choose a color'; 'Red'; 'Yellow'; 'Green'; 'Blue'; 'Magenta'; 'Black'; },...
    'Style','popupmenu',...
    'Value',1,...
    'Callback',@colorPopup_Callback);

hlineStylePopup = uicontrol(...
    'Parent',hlineStylePanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[31.6 2.23076923076923 22.2 1.76923076923077],...
    'String',{  'Line Style'; 'Solid'; 'Dotted'; 'Dashed'; 'DotDash'; 'none' },...
    'Style','popupmenu',...
    'Value',1,...
    'Callback',@lineStylePopup_Callback);

htext7 = uicontrol(...
    'Parent',hlineStylePanel,...
    'Units','characters',...
    'BackgroundColor',[0 0.250980392156863 0.501960784313725],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'HorizontalAlignment','left',...
    'Position',[57.8 2.23076923076923 14.2 1.61538461538462],...
    'String','Line width:',...
    'Style','text');

hlineWidthEditBox = uicontrol(...
    'Parent',hlineStylePanel,...
    'Units','characters',...
    'BackgroundColor',[0.501960784313725 0.501960784313725 1],...
    'FontSize',10,...
    'ForegroundColor',[1 1 0.501960784313725],...
    'Position',[72.6 2.38461538461538 6 1.61538461538462],...
    'String','',...
    'Style','edit',...
    'Callback',@lineWidthEditBox_Callback);

handle_list=[hfigure,hequationPanel,...
    henterEquationText,henterEquationEditBox,...
    henterDomainText,hxMinText,hxMinEditBox,...
    hxMaxText,hxMaxEditBox,...
    hnumberOfPointsText,hnumberOfPointsEditBox,...
    hgraphPushButton,hfindPanel,hfindText,...
    hrootsPushButton,hlocalMinPushButton,...
    hlocalMaxPushButton,hequationGraph,...
    hlineStylePanel,hcolorPopup,hlineStylePopup,...
    htext7,hlineWidthEditBox];
set(handle_list,'units','normalized')

    function graphPushButton_Callback(hObject, eventdata, handles)
        xmin=str2double(get(hxMinEditBox,'string'));
        xmax=str2double(get(hxMaxEditBox,'string'));
        numpoints=str2double(get(hnumberOfPointsEditBox,'string'));
        scale=(xmax-xmin)/numpoints;

        x=linspace(xmin,xmax,numpoints);
        eqnstr=get(henterEquationEditBox,'string');
        y=eval(eqnstr);
        plot(x,y,'Tag','Plot')
        set(hequationGraph,'Color',[.976,.992,.635])
        grid on

        v=axis;
        ymin=v(3);
        ymax=v(4);
        v(3)=ymin-0.2*(ymax-ymin);
        v(4)=ymax+0.2*(ymax-ymin);
        axis(v)
    end

    function rootsPushButton_Callback(hObject, eventdata)
        xy=ginput(1);
        eqnstr=get(henterEquationEditBox,'string');
        eqn=fcnchk(eqnstr);
        z=fzero(eqn,xy(1));
        line(z,0,'linestyle','none','marker','.',...
            'markersize',20,'color','r')
        rootTextStr=sprintf('%.4f,0',z);
        text(z,0,rootTextStr,...
            'horiz','center',...
            'vert','top')
    end

    function localMinPushButton_Callback(hObject, eventdata)
        xy=ginput(2);
        leftBound=xy(1);
        rightBound=xy(2);
        eqnStr=get(henterEquationEditBox,'string');
        y=fcnchk(eqnStr);
        [xcoor,ycoor]=fminbnd(y,leftBound,rightBound);
        line(xcoor,ycoor,'linestyle','none','marker','.',...
            'markersize',20,'color','r')
        minStr=sprintf('(%.4f,%.4f)',xcoor,ycoor);
        text(xcoor,ycoor,minStr,...
            'horiz','center','vert','top')
    end

    function localMaxPushButton_Callback(hObject,eventdata)
        xy=ginput(2);
        leftBound=xy(1);
        rightBound=xy(2);
        eqnStr=get(henterEquationEditBox,'string');
        y=@(x) eval(eqnStr);
        y1=@(x) -y(x);
        [xcoor,ycoor]=fminbnd(y1,leftBound,rightBound);
        line(xcoor,-ycoor,'linestyle','none','marker','.',...
            'markersize',20,'color','r')
        maxStr=sprintf('(%.4f,%.4f)',xcoor,-ycoor);
        text(xcoor,-ycoor,maxStr,...
            'horiz','center','vert','top')
    end

    function colorPopup_Callback(hObject,eventdata)
        colors=get(hcolorPopup,'string');
        index=get(hcolorPopup,'value');
        color=colors{index};
        switch color
            case 'Red'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'color','r')
            case 'Blue'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'color','b')
            case 'Yellow'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'color','y')
            case 'Green'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'color','g')
            case 'Magenta'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'color','m')
            case 'Black'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'color','k')
        end
    end

    function lineStylePopup_Callback(hObject,eventdata)
        styles=get(hlineStylePopup,'string');
        index=get(hlineStylePopup,'value');
        linestyle=styles{index};
        switch linestyle
            case 'Solid'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'linestyle','-')
            case 'Dotted'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'linestyle',':')
            case 'Dashed'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'linestyle','--')
            case 'DotDash'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'linestyle','-.')
            case 'none'
                h=findobj(hequationGraph,'Tag','Plot');
                set(h,'linestyle','none')
        end
    end

    function lineWidthEditBox_Callback(hObject,eventdata)
        width=str2double(get(hlineWidthEditBox,'string'));
        h=findobj(hequationGraph,'Tag','Plot');
        set(h,'linewidth',width)
    end


end


