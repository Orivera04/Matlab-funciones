function polartrc(option)
%POLARTRC Traces two polar plots simultaneously
%
%	Call routine as follows:
%
%	polartrc
%
%	No input needed. A GUI is created and should be
%	self explanatory with a little experimentation on
%	the part of the user.

global counter rho1 rho2 theta x1 x2 y1 y2 a b n
if nargin==0
	figure('name','Polar Trace',...
		'numbertitle','off',...
		'units','normalized',...
		'position',[0.1 0.1 .8 .8]);
	axes('units','normalized',...
		'pos',[0.10 0.30 0.70 0.65],...
		'nextplot','add');
	axis('equal')
	a=0;
	b=2*pi;
	n=48;
	theta=a:(b-a)/n:b;
	rho1=1+cos(theta);
	x1=rho1.*cos(theta);
	y1=rho1.*sin(theta);	
	plot(x1,y1,'m-','tag','graph#1');
	plot([0 x1(1)],[0 y1(1)],'m-','erasemode','xor','tag','ray1');
	plot(x1(1),y1(1),'mo','erasemode','xor','tag','cursor1');

	rho2=1-cos(theta);
	x2=rho2.*cos(theta);
	y2=rho2.*sin(theta);
	plot(x2,y2,'g-','tag','graph#2');
	plot([0 x2(1)],[0 y2(1)],'g-','erasemode','xor','tag','ray2');
	plot(x2(1),y2(1),'go','erasemode','xor','tag','cursor2');

	counter=1;
	theta=theta*180/pi;
	

	uicontrol('style','pushbutton',...
		'units','normalized',...
		'pos',[0.85 0.85 0.1 0.075],...
		'string','-->',...
		'callback','polartrc forward');
	uicontrol('style','pushbutton',...
		'units','normalized',...
		'pos',[0.85 0.75 0.1 0.075],...
		'string','Reset',...
		'callback','polartrc reset');
	uicontrol('style','pushbutton',...
		'units','normalized',...
		'pos',[0.85 0.65 0.1 0.075],...
		'string','<--',...
		'callback','polartrc backward');
	uicontrol('style','pushbutton',...
		'units','normalized',...
		'pos',[0.85 0.55 0.1 0.075],...
		'string','Go',...
		'callback','polartrc go');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.85 0.45 0.05 0.05],...
		'string','a = ',...
		'horiz','right',...
		'backgroundcolor','r',...
		'foregroundcolor','w');
	uicontrol('style','edit',...
		'tag','a',...
		'units','normalized',...
		'pos',[0.90 0.45 0.05 0.05],...
		'string','0',...
		'horiz','left',...
		'backgroundcolor','r',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.85 0.35 0.05 0.05],...
		'string','b = ',...
		'horiz','right',...
		'backgroundcolor','r',...
		'foregroundcolor','w');
	uicontrol('style','edit',...
		'tag','b',...
		'units','normalized',...
		'pos',[0.90 0.35 0.05 0.05],...
		'string','2*pi',...
		'horiz','left',...
		'backgroundcolor','r',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.85 0.25 0.05 0.05],...
		'string','n = ',...
		'horiz','right',...
		'backgroundcolor','r',...
		'foregroundcolor','w');
	uicontrol('style','edit',...
		'tag','n',...
		'units','normalized',...
		'pos',[0.90 0.25 0.05 0.05],...
		'string','48',...
		'horiz','left',...
		'backgroundcolor','r',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.05 0.15 0.10 0.05],...
		'string','rho1 = ',...
		'horiz','right',...
		'backgroundcolor','m',...
		'foregroundcolor','w');
	uicontrol('style','edit',...
		'tag','eqrho1',...
		'units','normalized',...
		'pos',[0.15 0.15 0.30 0.05],...
		'string','1+cos(theta)',...
		'horiz','left',...
		'backgroundcolor','m',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.5 0.15 0.10 0.05],...
		'string','rho1 = ',...
		'horiz','right',...
		'backgroundcolor','m',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'tag','rho1',...
		'units','normalized',...
		'pos',[0.60 0.15 0.10 0.05],...
		'string',num2str(rho1(1)),...
		'horiz','left',...
		'backgroundcolor','m',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.75 0.15 0.10 0.05],...
		'string','theta = ',...
		'horiz','right',...
		'backgroundcolor','m',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'tag','theta1',...
		'units','normalized',...
		'pos',[0.85 0.15 0.10 0.05],...
		'string',num2str(0),...
		'horiz','left',...
		'backgroundcolor','m',...
		'foregroundcolor','w');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.05 0.05 0.10 0.05],...
		'string','rho2 = ',...
		'horiz','right',...
		'backgroundcolor','g',...
		'foregroundcolor','b');
	uicontrol('style','edit',...
		'tag','eqrho2',...
		'units','normalized',...
		'pos',[0.15 0.05 0.30 0.05],...
		'string','1-cos(theta)',...
		'horiz','left',...
		'backgroundcolor','g',...
		'foregroundcolor','b');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.5 0.05 0.10 0.05],...
		'string','rho2 = ',...
		'horiz','right',...
		'backgroundcolor','g',...
		'foregroundcolor','b');
	uicontrol('style','text',...
		'tag','rho2',...
		'units','normalized',...
		'pos',[0.60 0.05 0.10 0.05],...
		'string',num2str(rho2(1)),...
		'horiz','left',...
		'backgroundcolor','g',...
		'foregroundcolor','b');
	uicontrol('style','text',...
		'units','normalized',...
		'pos',[0.75 0.05 0.10 0.05],...
		'string','theta = ',...
		'horiz','right',...
		'backgroundcolor','g',...
		'foregroundcolor','b');
	uicontrol('style','text',...
		'tag','theta2',...
		'units','normalized',...
		'pos',[0.85 0.05 0.10 0.05],...
		'string',num2str(0),...
		'horiz','left',...
		'backgroundcolor','g',...
		'foregroundcolor','b');

	
elseif strcmp(option,'go');
	edithndl=findobj(gcf,'style','edit','tag','a');
	a=str2num(get(edithndl,'string'));
	edithndl=findobj(gcf,'style','edit','tag','b');
	b=str2num(get(edithndl,'string'));
	edithndl=findobj(gcf,'style','edit','tag','n');
	n=str2num(get(edithndl,'string'));
	theta=a:(b-a)/n:b;
	edithndl=findobj(gcf,'style','edit','tag','eqrho1');
	rho1=get(edithndl,'string');
	rho1=vectorize(rho1);
	if isempty(findstr(rho1,'theta'))
		rho1=str2num(rho1)*ones(size(theta));
	else
		rho1=eval(rho1);
	end
	x1=rho1.*cos(theta);

	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	%Delete if unsuccessful
	%xidx=find(real(x1~=x1));
	%x1(xidx)=NaN*ones(size(xidx));
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

	y1=rho1.*sin(theta);
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	%Delete if unsuccessful
	%yidx=find(real(y1~=y1));
	%y1(yidx)=NaN*ones(size(yidx));
	%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
	
	linehndl=findobj(gca,'tag','graph#1');
	set(linehndl,'xdata',x1,'ydata',y1);
	edithndl=findobj(gcf,'style','edit','tag','eqrho2');
	rho2=get(edithndl,'string');
	rho2=vectorize(rho2);
	if isempty(findstr(rho2,'theta'))
		rho2=str2num(rho2)*ones(size(theta));
	else
		rho2=eval(rho2);
	end
	x2=rho2.*cos(theta);
	y2=rho2.*sin(theta);
	linehndl=findobj(gca,'tag','graph#2');
	set(linehndl,'xdata',x2,'ydata',y2);
	theta=theta*180/pi;	
elseif strcmp(option,'forward')
	if counter<n+1
		counter=counter+1;
		txthndl=findobj(gcf,'style','text','tag','rho1');
		set(txthndl,'string',num2str(rho1(counter)));
		txthndl=findobj(gcf,'style','text','tag','theta1');
		set(txthndl,'string',num2str(theta(counter)));
		linehndl=findobj(gca,'tag','ray1');
		set(linehndl,'xdata',[0 x1(counter)],'ydata',[0 y1(counter)]);
		linehndl=findobj(gca,'tag','cursor1');
		set(linehndl,'xdata',x1(counter),'ydata',y1(counter));
		txthndl=findobj(gcf,'style','text','tag','rho2');
		set(txthndl,'string',num2str(rho2(counter)));
		txthndl=findobj(gcf,'style','text','tag','theta2');
		set(txthndl,'string',num2str(theta(counter)));
		linehndl=findobj(gca,'tag','ray2');
		set(linehndl,'xdata',[0 x2(counter)],'ydata',[0 y2(counter)]);
		linehndl=findobj(gca,'tag','cursor2');
		set(linehndl,'xdata',x2(counter),'ydata',y2(counter));
	end	
elseif strcmp(option,'backward')
	if counter>1
		counter=counter-1;
		txthndl=findobj(gcf,'style','text','tag','rho1');
		set(txthndl,'string',num2str(rho1(counter)));
		txthndl=findobj(gcf,'style','text','tag','theta1');
		set(txthndl,'string',num2str(theta(counter)));
		linehndl=findobj(gca,'tag','ray1');
		set(linehndl,'xdata',[0 x1(counter)],'ydata',[0 y1(counter)]);
		linehndl=findobj(gca,'tag','cursor1');
		set(linehndl,'xdata',x1(counter),'ydata',y1(counter));
		txthndl=findobj(gcf,'style','text','tag','rho2');
		set(txthndl,'string',num2str(rho2(counter)));
		txthndl=findobj(gcf,'style','text','tag','theta2');
		set(txthndl,'string',num2str(theta(counter)));
		linehndl=findobj(gca,'tag','ray2');
		set(linehndl,'xdata',[0 x2(counter)],'ydata',[0 y2(counter)]);
		linehndl=findobj(gca,'tag','cursor2');
		set(linehndl,'xdata',x2(counter),'ydata',y2(counter));
	end
elseif strcmp(option,'reset')
	counter=1;
	txthndl=findobj(gcf,'style','text','tag','rho1');
	set(txthndl,'string',num2str(rho1(counter)));
	txthndl=findobj(gcf,'style','text','tag','theta1');
	set(txthndl,'string',num2str(theta(counter)));
	linehndl=findobj(gca,'tag','ray1');
	set(linehndl,'xdata',[0 x1(counter)],'ydata',[0 y1(counter)]);
	linehndl=findobj(gca,'tag','cursor1');
	set(linehndl,'xdata',x1(counter),'ydata',y1(counter));
	txthndl=findobj(gcf,'style','text','tag','rho2');
	set(txthndl,'string',num2str(rho2(counter)));
	txthndl=findobj(gcf,'style','text','tag','theta2');
	set(txthndl,'string',num2str(theta(counter)));
	linehndl=findobj(gca,'tag','ray2');
	set(linehndl,'xdata',[0 x2(counter)],'ydata',[0 y2(counter)]);
	linehndl=findobj(gca,'tag','cursor2');
	set(linehndl,'xdata',x2(counter),'ydata',y2(counter));
end
