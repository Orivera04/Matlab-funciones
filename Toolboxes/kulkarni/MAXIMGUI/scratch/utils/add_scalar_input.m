function [scalar_input] = add_scalar_input(title_bar, varname, varlabel,init_scalar)

% Editable input dialogue box - returns scalar for variable specified
% Usage:  title_bar: String to appear in title bar of input figure
%         varname: variable name (used for validation)
%         varlabel: label for input
global Scale cancel_win

valid_input = 0 ;
scalar_input = init_scalar ;
cancel_win = 0 ;
while (valid_input == 0)
   
% display main figure
scalarfig = figure('Name', title_bar, ...
                  'NumberTitle','off', ...
                  'Units','normalized', ...
                  'Color',[0.76 0.76 0.76], ...
                  'Position',[.3 .3 .3 .3], ...
                  'Menubar','none',...
                  'Tag','ScalarInputFig');

% display labels
uicontrol('Parent',scalarfig, ...
          'Units','normalized', ...
          'Position',[.05 .7 .9 .2], ...
          'Style','text', ...
          'BackgroundColor', [0.76 0.76 0.76], ...
          'Fontname','time roman', ...
          'Fontsize', Scale*12, ...
          'HorizontalAlignment','left',...
          'String', sprintf('%s :', varlabel)) ;

% display input box
scalar_value = uicontrol('Parent',scalarfig, ...
                        'Units','normalized', ...
                        'BackgroundColor',[1 1 1], ...
                        'Position',[.4 .4 .20 .15], ...
                        'HorizontalAlignment','center',...
                        'Fontsize',Scale*12, ...
                        'String', scalar_input, ...
          	            'Style','edit', ...
                        'Tag', 'ScalarValue') ;

% Add action buttons
uicontrol('Parent',scalarfig, ...
          'Units','normalized', ...
          'BackgroundColor', [0.76 0.76 0.76], ...
          'Callback', 'uiresume(gcbf)',...
          'FontName','time roman', ...
          'Fontsize',Scale*14, ...
          'Position',[.3 .05 .20 .15], ...
          'String','OK') ;

uicontrol('Parent',scalarfig, ...
          'Units','normalized', ...
          'BackgroundColor', [0.76 0.76 0.76], ...
          'Callback', ['set_cancel;uiresume(gcbf);'],...
          'FontName','time roman', ...
          'Fontsize',Scale*14, ...
	       'Position',[.55 .05 .30 .15], ...
          'String','Cancel', ...
          'Tag', 'Cancel') ;

       uiwait(scalarfig) 
       
       if cancel_win == 0
          scalar_input = str2num(get(scalar_value, 'String'));
          valid_input = validate_add_scalar_input(varname,scalar_input);
       else
          scalar_input = [];
          valid_input = 1; %to get out of the loop
       end;
       if valid_input == 0
          close(scalarfig)
       end
       
 

end %while loop
   
   
close(scalarfig) ;
