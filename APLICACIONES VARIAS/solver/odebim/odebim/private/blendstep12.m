function  [y,z]=...
    blendstep12(m,y0,f0,y,f,h,gamma,imas,m0,L,U,P,Q)
k=10;
da = [-1.238504702421455e+000   -9.602642645507413e-001   -7.312038597616039e-001   -1.270464308215125e+000   -1.025250063476562e+000   -8.067753268263254e-001   -1.087894266876837e+000   -1.041771022507008e+000   -9.417290146092545e-001   -1.064330000000000e+000
    3.210504894499178e+000   -1.711280013084444e-002   -9.384193589180667e-001    9.310079634375111e-001    8.156922743055556e-002   -6.553186339669334e-001    2.937660670063778e-001    1.569347228558222e-001   -2.549558995186000e-001    7.147777777777777e-001
   -5.221191637623150e+000    2.143601300294400e+000    2.292371682565650e+000   -2.140717917734400e+000   -1.595984700520833e-001    1.453789426425600e+000   -6.328292757643500e-001   -4.143697930922667e-001    8.062726489168500e-001   -3.618562500000000e+000
    7.995518466885600e+000   -2.355740089412267e+000   -2.157859102338934e+000    4.050787409305600e+000    1.986380208333334e-001   -2.523247869201067e+000    1.049978156914400e+000    8.891433358677333e-001   -1.984773598074400e+000    1.102800000000000e+001
   -9.931230487787349e+000    2.341392200686933e+000    3.660204759319850e+000   -3.598306808046933e+000    7.433968098958334e-002    3.150937828326400e+000   -1.213920810116817e+000   -1.467207294993067e+000    3.618212847472650e+000   -2.251550000000000e+001
    9.263795268275857e+000   -2.007571179326123e+000   -3.919075568947056e+000    3.868856135725056e+000    1.443273906250000e+000   -2.561724315193344e+000    8.501469777121440e-001    1.888849669860011e+000   -4.932488733573744e+000    3.242232000000000e+001
   -6.320613658524900e+000    1.310755911569067e+000    2.815394839546567e+000   -2.901138983142400e+000   -8.439124348958333e-001    3.079181885550933e+000    6.632223769990001e-002   -1.978827085550933e+000    5.114001898315100e+000   -3.377325000000000e+001
    3.059050771522400e+000   -6.174962287957333e-001   -1.401943901002400e+000    1.455975556369067e+000    3.039401041666667e-001   -1.501506229657600e+000    1.030313972010933e+000    1.949488096324267e+000   -4.159017256317600e+000    2.573200000000000e+001
   -9.951354094057875e-001    1.972551167402667e-001    4.645360456414125e-001   -4.834857294336000e-001   -8.776420084635417e-002    4.409879816064000e-001   -4.115066939410875e-001    1.397642183936000e-001    2.993030662229212e+000   -1.447425000000000e+001
    1.952935685246000e-001   -3.820759507626666e-002   -9.235585469460000e-002    9.618409470293333e-002    1.615429687500000e-002   -8.370503340373334e-002    6.043758769206667e-002   -1.277874999296000e-001   -1.959689888354000e-001    6.433000000000000e+000
   -1.748707394499178e-002    3.387628001308444e-003    8.350318589180667e-003   -8.697412967708445e-003   -1.390067274305556e-003    7.380286339669333e-003   -4.813952336730445e-003    5.782652771441778e-003   -6.258456600481401e-002   -8.842052777777778e-001];
  
a2 = [2.385047024214545e-001   -3.973573544925867e-002   -2.687961402383962e-001    2.704643082151254e-001    2.525006347656250e-002   -1.932246731736747e-001    8.789426687683717e-002    4.177102250700800e-002   -5.827098539074550e-002    6.433000000000000e-002
   -2.210504894499178e+000    1.711280013084444e-002    9.384193589180667e-001   -9.310079634375111e-001   -8.156922743055556e-002    6.553186339669334e-001   -2.937660670063778e-001   -1.569347228558222e-001    2.549558995186000e-001   -7.147777777777777e-001
    5.221191637623150e+000   -1.143601300294400e+000   -2.292371682565650e+000    2.140717917734400e+000    1.595984700520833e-001   -1.453789426425600e+000    6.328292757643500e-001    4.143697930922667e-001   -8.062726489168500e-001    3.618562500000000e+000
   -7.995518466885600e+000    2.355740089412267e+000    3.157859102338934e+000   -4.050787409305600e+000   -1.986380208333334e-001    2.523247869201067e+000   -1.049978156914400e+000   -8.891433358677333e-001    1.984773598074400e+000   -1.102800000000000e+001
    9.931230487787349e+000   -2.341392200686933e+000   -3.660204759319850e+000    4.598306808046933e+000   -7.433968098958334e-002   -3.150937828326400e+000    1.213920810116817e+000    1.467207294993067e+000   -3.618212847472650e+000    2.251550000000000e+001
   -9.263795268275857e+000    2.007571179326123e+000    3.919075568947056e+000   -3.868856135725056e+000   -4.432739062500000e-001    2.561724315193344e+000   -8.501469777121440e-001   -1.888849669860011e+000    4.932488733573744e+000   -3.242232000000000e+001
    6.320613658524900e+000   -1.310755911569067e+000   -2.815394839546567e+000    2.901138983142400e+000    8.439124348958333e-001   -2.079181885550933e+000   -6.632223769990001e-002    1.978827085550933e+000   -5.114001898315100e+000    3.377325000000000e+001
   -3.059050771522400e+000    6.174962287957333e-001    1.401943901002400e+000   -1.455975556369067e+000   -3.039401041666667e-001    1.501506229657600e+000   -3.031397201093333e-002   -1.949488096324267e+000    4.159017256317600e+000   -2.573200000000000e+001
    9.951354094057875e-001   -1.972551167402667e-001   -4.645360456414125e-001    4.834857294336000e-001    8.776420084635417e-002   -4.409879816064000e-001    4.115066939410875e-001    8.602357816064000e-001   -2.993030662229212e+000    1.447425000000000e+001
   -1.952935685246000e-001    3.820759507626666e-002    9.235585469460000e-002   -9.618409470293333e-002   -1.615429687500000e-002    8.370503340373334e-002   -6.043758769206667e-002    1.277874999296000e-001    1.195968988835400e+000   -6.433000000000000e+000
    1.748707394499178e-002   -3.387628001308444e-003   -8.350318589180667e-003    8.697412967708445e-003    1.390067274305556e-003   -7.380286339669333e-003    4.813952336730445e-003   -5.782652771441778e-003    6.258456600481401e-002    1.884205277777778e+000];
db = [3.886511017048409e-001    2.511424955730658e-001    1.870572550202376e-001    3.687673161686370e-001    2.788328416416698e-001    2.083041071140353e-001    3.069694839813847e-001    2.863690656134195e-001    2.578610954240839e-001    2.683414836192614e-001
    6.759174036853367e-001    1.787280939023858e+000    1.668693953974796e+000    1.685469369652376e+000    1.751421559470647e+000    1.707656485368904e+000    1.684804753427098e+000    1.725167523511750e+000    1.697727342669132e+000    1.775359414248303e+000
   -1.630313399807119e+000   -1.786465460175264e+000   -2.791395339580082e-001   -3.705733627302255e-001   -6.628864218286706e-001   -4.683827555886380e-001   -3.633136165021888e-001   -5.482979475136338e-001   -4.162183545110935e-001   -8.104357062690396e-001
    2.410981970326333e+000    3.031004425252792e+000    2.006250661983260e+000    3.265068061930807e+000    4.015915084899970e+000    3.509020681569701e+000    3.219458738656043e+000    3.725643439107492e+000    3.342237040601011e+000    4.549462882796216e+000
   -2.742089094014645e+000   -4.340033758301733e+000   -2.621378837042134e+000   -2.815017432893904e+000   -3.070792591255724e+000   -2.232929049889834e+000   -1.696566295734494e+000   -2.617794889690315e+000   -1.868222856766055e+000   -4.351551226551226e+000
    2.294269423840502e+000    4.476234513489415e+000    2.234203711593418e+000    2.321560037638469e+000    4.010394220177063e+000    4.111800574153516e+000    3.383927780190035e+000    4.565833585441428e+000    3.518702249547838e+000    7.137646304312971e+000
   -1.379432844014646e+000   -3.320774499042473e+000   -1.388722587042134e+000   -1.531717432893903e+000   -3.088877081996465e+000   -2.236229049889834e+000   -4.639100457344942e-001   -1.598535630431055e+000   -5.055666067660553e-001   -4.351551226551226e+000
    5.764283988977617e-001    1.730686964935331e+000    6.064256619832600e-001    7.050680619308071e-001    1.566758338868225e+000    9.490206815697012e-001    5.330337386560425e-001    2.425325978790031e+000    1.507683469172440e+000    4.549462882796216e+000
   -1.576683105214049e-001   -6.022130792228831e-001   -1.757801589580082e-001   -2.162876484445112e-001   -5.350032373048611e-001   -3.140970413029237e-001   -2.599542415021888e-001   -6.506455665612528e-001    1.056426734774621e+000   -8.104357062690396e-001
    2.506561797105098e-002    1.257641841737702e-001    3.025645397479548e-002    3.975508393809048e-002    1.100387331919876e-001    6.194219965461795e-002    4.636725342709820e-002    6.365076866166190e-002   -2.397244430451538e-001    1.775359414248303e+000
   -1.717306395870530e-003   -1.193356127451988e-002   -2.328100754622405e-003   -3.312369064003051e-003   -1.030632867634161e-002   -5.551362822604653e-003   -3.847469941475252e-003   -6.365076866166191e-003   -1.166001105262748e-002   -3.749585163807386e-001];
b = [-1.033929616721400e-001    1.600683556864000e-002    9.116151922514000e-002   -9.207968523264000e-002   -8.795117187500000e-003    6.614453006336001e-002   -3.027007892286000e-002   -1.365125006336000e-002    1.745433995186000e-002                         0];
if(imas==0)
    z = [y0 y]*da;
    z=z-h*[f0 f]*db;
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
    z=z+[y0 y]*a2;
    z=z-h*(f0*b+gamma*f);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
else
    z=[y0 y]*da;
    mz = m0*z;
    mz=mz-h*[f0 f]*db;
    mz(1:m,1:k) = sollu(L,U,P,Q,mz(1:m,1:k));
    mz=mz+[y0 y]*a2;
    z = m0*mz;
    z=z-h*(f0*b+gamma*f);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
end
y = y-z;