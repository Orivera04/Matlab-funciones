function  [y,z]=...
    blendstep6(m,y0,f0,y,f,h,gamma,imas,m0,L,U,P,Q)
k=4;
da = [-2.288337890625000e-001   -9.602406250000000e-001   -1.143299414062500e+000   -1.212050000000000e+000
       6.333302083333333e-001    3.534166666666667e-001   -1.325312500000000e-002    1.130933333333333e+000
      -4.671726562500000e-001    1.159037500000000e+000    9.641648437500000e-001   -2.544600000000000e+000
       6.626562500000000e-002   -6.361500000000000e-001    4.301156250000000e-001    3.392800000000000e+000
      -3.589388020833334e-003    8.393645833333334e-002   -2.377279296875000e-001   -7.670833333333333e-001];

a2 = [-7.711662109375000e-001   -3.975937500000000e-002    1.432994140625000e-001    2.120500000000000e-001
       3.666697916666667e-001   -3.534166666666667e-001    1.325312500000000e-002   -1.130933333333333e+000
       4.671726562500000e-001   -1.590375000000000e-001   -9.641648437500000e-001    2.544600000000000e+000
      -6.626562500000000e-002    6.361500000000000e-001    5.698843750000000e-001   -3.392800000000000e+000
       3.589388020833334e-003   -8.393645833333334e-002    2.377279296875000e-001    1.767083333333333e+000];
   
db = [5.235329861111111e-003    3.580986111111111e-001    4.818783854166667e-001    3.111111111111111e-001
      3.490222222222222e-001    1.022222222222222e+000    1.108333333333333e+000    1.422222222222222e+000
     -8.166666666666667e-001   -4.820000000000000e-002    1.150000000000000e+000    5.333333333333333e-001
      4.472222222222222e-001   -3.111111111111111e-001   -4.898666666666667e-001    1.422222222222222e+000
     -1.013888888888889e-001    7.777777777777778e-002    4.166666666666667e-003   -5.370888888888888e-001];
 
b =  [2.683757812500000e-001    5.301250000000000e-002   -1.027117187500000e-001                         0];

if((imas+1)==1)
    z = [y0 y]*da;
    z=z-h*[f0 f]*db;
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
    z=z+[y0 y]*a2;
    z=z-h*(f0*b+gamma*f);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
else
    z=[y0 y]*(da);
    mz = m0*z;
    mz=mz-h*[f0 f]*(db);
    mz(1:m,1:k) = sollu(L,U,P,Q,mz(1:m,1:k));
    mz=mz+[y0 y]*(a2);
    z = m0*mz;
    z=z-h*(f0*b+f*gamma);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
end
y = y-z;