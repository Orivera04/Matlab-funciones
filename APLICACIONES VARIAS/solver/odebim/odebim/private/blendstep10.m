function  [y,z]=...
    blendstep10(m,y0,f0,y,f,h,gamma,imas,m0,L,U,P,Q)
k=8;
da = [ -8.316231078334153e-001   -1.343097172737122e+000   -6.860686349657674e-001   -9.666043457031250e-001   -1.200819994825870e+000   -9.260000515619914e-001   -9.665559780783951e-001   -1.084312500000000e+000
    1.826938991144725e+000    1.167165884835379e+000   -9.604163169520242e-001   -7.969538690476191e-002    5.741141156128474e-001   -1.910934343610491e-001   -1.754056405226390e-001    7.708571428571429e-001
   -1.927724484503269e+000   -6.451529846191406e-002    1.933666054666042e+000    4.953359375000000e-002   -9.344392856558164e-001    2.332385101318359e-001    5.823807042479515e-001   -3.147666666666667e+000
    1.783382646004359e+000    9.247203979492188e-001   -8.250297395547231e-001    2.936885416666667e-001    1.058557936429977e+000   -8.615134684244792e-002   -1.327349272330602e+000    7.554400000000000e+000
   -1.426009772295753e+000   -1.288487873077393e+000    1.152395068332553e+000    1.230541992187500e+000   -4.654449404031038e-001   -3.407956123352051e-001    2.105080046976606e+000   -1.180375000000000e+001
    8.339545876026153e-001    9.145655721028646e-001   -9.398828437328338e-001   -6.871468750000001e-001    1.533959761857987e+000    1.027509191894531e+000   -2.448934563398361e+000    1.259066666666667e+001
   -3.278081615010897e-001   -3.998050994873047e-001    4.197220182220141e-001    1.963778645833333e-001   -6.862019841074943e-001    4.931795033772787e-001    2.397493568082651e+000   -9.443000000000000e+000
    7.706764499346415e-002    1.006645141601563e-001   -1.062303922176361e-001   -4.075104166666667e-002    1.336362001895905e-001   -2.255194702148438e-001   -8.338056769371033e-002    5.396000000000000e+000
   -8.178343611636331e-003   -1.121092528388614e-002    1.184478620237538e-002    4.055657087053572e-003   -1.336180909811741e-002    1.563270991189139e-002   -8.332829728350043e-002   -8.331946428571428e-001];

a2 = [-1.683768921665847e-001    3.430971727371216e-001   -3.139313650342325e-001   -3.339565429687500e-002    2.008199948258698e-001   -7.399994843800863e-002   -3.344402192160487e-002    8.431250000000000e-002
   -8.269389911447252e-001   -1.167165884835379e+000    9.604163169520242e-001    7.969538690476191e-002   -5.741141156128474e-001    1.910934343610491e-001    1.754056405226390e-001   -7.708571428571429e-001
    1.927724484503269e+000    1.064515298461914e+000   -1.933666054666042e+000   -4.953359375000000e-002    9.344392856558164e-001   -2.332385101318359e-001   -5.823807042479515e-001    3.147666666666667e+000
   -1.783382646004359e+000   -9.247203979492188e-001    1.825029739554723e+000   -2.936885416666667e-001   -1.058557936429977e+000    8.615134684244792e-002    1.327349272330602e+000   -7.554400000000000e+000
    1.426009772295753e+000    1.288487873077393e+000   -1.152395068332553e+000   -2.305419921875000e-001    4.654449404031038e-001    3.407956123352051e-001   -2.105080046976606e+000    1.180375000000000e+001
   -8.339545876026153e-001   -9.145655721028646e-001    9.398828437328338e-001    6.871468750000001e-001   -5.339597618579864e-001   -1.027509191894531e+000    2.448934563398361e+000   -1.259066666666667e+001
    3.278081615010897e-001    3.998050994873047e-001   -4.197220182220141e-001   -1.963778645833333e-001    6.862019841074943e-001    5.068204966227213e-001   -2.397493568082651e+000    9.443000000000000e+000
   -7.706764499346415e-002   -1.006645141601563e-001    1.062303922176361e-001    4.075104166666667e-002   -1.336362001895905e-001    2.255194702148438e-001    1.083380567693710e+000   -5.396000000000000e+000
    8.178343611636331e-003    1.121092528388614e-002   -1.184478620237538e-002   -4.055657087053572e-003    1.336180909811741e-002   -1.563270991189139e-002    8.332829728350043e-002    1.833194642857143e+000];

db = [    2.797418832186416e-001    3.977655613254386e-001    1.666573006439087e-001    2.842827188553565e-001    3.624000511461724e-001    2.526116870210923e-001    2.824378357148776e-001    2.790828924162258e-001
    4.300771396813063e-001    1.686507002697479e+000    1.637316349325278e+000    1.506061909871434e+000    1.583138243480506e+000    1.635184498041641e+000    1.560320840425007e+000    1.661516754850088e+000
   -8.263829187787521e-001   -1.316692498859166e+000   -1.146474012099012e-001    3.203177069843737e-001    6.055797982881316e-002   -1.302886002886003e-001    1.463712714754381e-001   -2.618694885361552e-001
    6.568911682453349e-001    1.593908807242141e+000    1.492518016705517e+000    1.704338131004798e+000    2.176131064151897e+000    2.589148629148629e+000    1.989954216308383e+000    2.961834215167548e+000
   -2.806935734019068e-001   -1.692650559317226e+000   -1.732042610167610e+000   -5.573036161369495e-001   -6.198469740136407e-003   -6.150072150072150e-001    2.369061879478546e-001   -1.281128747795415e+000
   -1.799309101392435e-002    1.193908807242141e+000    1.151393016705517e+000    4.507887174553842e-002    4.860060641518975e-001    2.189148629148629e+000    1.315069957049124e+000    2.961834215167548e+000
    8.669578492495159e-002   -5.421924988591655e-001   -5.052724012099013e-001    2.402141068807736e-002   -3.300670201711868e-001   -7.047886002886002e-001    1.059449975179142e+000   -2.618694885361552e-001
   -4.021452698536032e-002    1.436498598403360e-001    1.306199207538493e-001   -1.774761393809013e-002    7.644181490907681e-002    9.232735518449804e-002   -2.589708262416596e-001    1.661516754850088e+000
    6.447740145656813e-003   -1.689803142184095e-002   -1.507190973708831e-002    3.276652800462324e-003   -8.134302591147830e-003   -1.154091939806226e-002   -1.391307959016292e-002   -3.954171075837742e-001];
b = [  3.093039396405220e-002   -1.218064498901367e-001    1.140297181904316e-001    1.317382812500000e-002   -7.477542516589165e-002    2.870453643798828e-002    7.873621731996537e-003                         0];
   
if(imas==0)
    z = [y0 y]*da;
    z=z-h*[f0 f]*db;
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
    z=z+[y0 y]*a2;
    z=z-h*(f0*b+gamma*f);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
else
    z=[y0 y]*da;
    mz = m0*z;
    mz=mz-h*[f0 f]*db;
    mz(1:m,1:k) = sollu(L,U,P,Q,mz(1:m,1:k));
    mz=mz+[y0 y]*a2;
    z = m0*mz;
    z=z-h*(f0*b+f*gamma);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
end
y = y-z;