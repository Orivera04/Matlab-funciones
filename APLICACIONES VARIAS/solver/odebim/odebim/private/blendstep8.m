function  [y,z]=...
    blendstep8(m,y0,f0,y,f,h,gamma,imas,m0,L,U,P,Q)
k = 6;
da = [-3.908321598508230e-001   -1.406221193415638e+000   -1.043634114583333e+000   -7.991378600823045e-001   -1.033328687628601e+000   -1.121416666666667e+000
       7.404156635802469e-001    1.226758024691358e+000    2.731875000000000e-002   -4.245086419753086e-001   -4.103433641975308e-002    8.742000000000000e-001
      -3.281341628086420e-001    2.557608024691358e-001    3.756328125000000e-001    2.878024691358025e-001    4.307200038580247e-001   -2.731875000000000e+000
      -1.130474108367627e-001    6.795336076817558e-002    1.151770833333333e+000    3.917311385459534e-001   -1.057399262688615e+000    4.856666666666667e+000
       1.394745852623457e-001   -2.203487654320988e-001   -6.317460937500000e-001    9.010679012345679e-001    1.733068335262346e+000   -5.463750000000000e+000
      -5.677353395061729e-002    8.993827160493827e-002    1.365937500000000e-001   -3.957283950617284e-001    9.330979938271605e-002    4.371000000000000e+000
       8.897018604252401e-003   -1.384050068587106e-002   -1.593593750000000e-002    3.877338820301783e-002   -1.253358517661180e-001   -7.848250000000000e-001];

a2 = [-6.091678401491769e-001    4.062211934156378e-001    4.363411458333334e-002   -2.008621399176955e-001    3.332868762860082e-002    1.214166666666667e-001
       2.595843364197531e-001   -1.226758024691358e+000   -2.731875000000000e-002    4.245086419753086e-001    4.103433641975308e-002   -8.742000000000000e-001
       3.281341628086420e-001    7.442391975308642e-001   -3.756328125000000e-001   -2.878024691358025e-001   -4.307200038580247e-001    2.731875000000000e+000
       1.130474108367627e-001   -6.795336076817558e-002   -1.517708333333333e-001   -3.917311385459534e-001    1.057399262688615e+000   -4.856666666666667e+000
      -1.394745852623457e-001    2.203487654320988e-001    6.317460937500000e-001    9.893209876543210e-002   -1.733068335262346e+000    5.463750000000000e+000
       5.677353395061729e-002   -8.993827160493827e-002   -1.365937500000000e-001    3.957283950617284e-001    9.066902006172840e-001   -4.371000000000000e+000
      -8.897018604252401e-003    1.384050068587106e-002    1.593593750000000e-002   -3.877338820301783e-002    1.253358517661180e-001    1.784825000000000e+000];
db = [ 1.413114068930041e-001    4.775332157554380e-001    2.996406250000000e-001    2.106258083480306e-001    3.403636555702528e-001    2.928571428571429e-001
       1.992777777777778e-001    1.370158730158730e+000    1.620000000000000e+000    1.503492063492063e+000    1.380158730158730e+000    1.542857142857143e+000
      -3.961805555555555e-001   -4.150079365079365e-001    8.437500000000001e-002    3.301587301587302e-001    6.728670634920635e-001    1.928571428571429e-001
       1.240740740740741e-001   -5.502645502645503e-002    8.215000000000000e-001    1.693121693121693e+000    1.128306878306878e+000    1.942857142857143e+000
       3.784722222222222e-002    9.126984126984127e-002   -7.593750000000000e-001   -6.205634920634920e-001    1.106894841269841e+000    1.928571428571429e-001
      -4.444444444444445e-002   -5.206349206349206e-002    2.700000000000000e-001    8.126984126984127e-002   -3.205634920634921e-001    1.542857142857143e+000
       1.053240740740741e-002    1.052910052910053e-002   -4.187500000000000e-002   -1.354497354497355e-002   -1.301256613756614e-002   -4.356428571428572e-001];

b =   [1.990821116255144e-001   -1.558930041152263e-001   -2.276562500000000e-002    8.694032921810700e-002   -2.351511059670782e-002                         0];

if((imas+1)==1)
    z = [y0 y]*da;
    z=z-h*[f0 f]*db;
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
    z=z+[y0 y]*a2;
    z=z-h*(f0*b+gamma*f);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
else
    z=[y0 y]*da;
    mz = m0*z;
    mz=mz-h*[f0 f]*db;
    mz(1:m,1:k) = sollu(L,U,P,Q,mz(1:m,1:k));
    mz=mz+[y0 y]*a2;
    z = m0*mz;
    z=z-h*(f0*b+f*gamma);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
end
y = y-z;