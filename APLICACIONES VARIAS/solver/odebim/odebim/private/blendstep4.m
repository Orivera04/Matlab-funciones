function  [y,z]=...
    blendstep4(m,y0,f0,y,f,h,gamma,imas,m0,L,U,P,Q)
k = 3;
da = [-2.521802469135803e-001  -1.173275308641975e+000   -7.537666666666667e-001
       5.485722222222222e-001   8.207777777777778e-001   -1.108050000000000e+000
      -3.283111111111111e-001   5.896111111111111e-001    2.216100000000000e+000
       3.191913580246913e-002  -2.371135802469136e-001   -3.542833333333333e-001];
   
a2 = [-7.478197530864198e-001    1.732753086419753e-001   -2.462333333333333e-001
       4.514277777777778e-001   -8.207777777777778e-001    1.108050000000000e+000
       3.283111111111111e-001    4.103888888888889e-001   -2.216100000000000e+000
      -3.191913580246913e-002    2.371135802469136e-001    1.354283333333333e+000];
  
db = [ 6.807407407407408e-002    4.273592592592593e-001    3.750000000000000e-001
       1.529666666666667e-001    1.133333333333333e+000    1.125000000000000e+000
      -3.083333333333334e-001   -2.053666666666667e-001    1.125000000000000e+000
       7.500000000000000e-002   -6.666666666666667e-002   -3.637000000000000e-001];
   
b  = [ 2.735925925925926e-001   -2.735925925925926e-002                         0];

if((imas+1)==1)
    z = [y0 y]*da;
    z=z-h*[f0 f]*db;
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
    z=z+[y0 y]*a2;
    z=z-h*(f0*b+gamma*f);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
else
    z=[y0 y]*(da);
    mz = m0*z;
    mz=mz-h*[f0 f]*(db);
    mz(1:m,1:k) = sollu(L,U,P,Q,mz(1:m,1:k));
    mz=mz+[y0 y]*(a2);
    z = m0*mz;
    z=z-h*(f0*b+f*gamma);
    z(1:m,1:k) = sollu(L,U,P,Q,z(1:m,1:k));
end
y = y-z;