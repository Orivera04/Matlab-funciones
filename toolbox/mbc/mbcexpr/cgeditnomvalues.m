function changed = cgeditnomvalues(pValues)
%CGEDITNOMVALUES Pop up a dialog for editing the nominal values of variables
%
%  CHANGED = CGEDITNOMVALUES(PVALUES) opens a small dialog that allows the
%  user to edit the nominal values of the variables in PVALUES.  CHANGED is
%  a logical vector the same length as PVALUES that indicates which of the
%  variables' values have been altered.

%  Copyright 2000-2004 The MathWorks, Inc. and Ford Global Technologies, Inc.

%  $Revision: 1.1.6.1 $    $Date: 2004/04/04 03:27:51 $ 

hFig = xregdialog('Name', 'Edit Set Points');
xregcenterfigure(hFig, [350 300]);

txt = uicontrol('Parent', hFig, ...
    'Style', 'text', ...
    'horizontalalignment', 'left', ...
    'enable', 'inactive', ...
    'string', ['Warning: changing a value here will update the set point', ...
    ' of the variable everywhere in CAGE.  This could alter the result of some', ...
    ' calculations and may change the appearance of any displays that depend on', ...
    ' the variable.']);

inputList = com.mathworks.toolbox.mbc.gui.table.InputListTable;
t = mbctable.editable(inputList,'parent',hFig);
cginitinputs(t.table, null(xregpointer, 0), pValues);
pChanges = xregGui.RunTimePointer(false(size(pValues)));
t.setEditCallback({@i_EditTable,pChanges});

hOK = uicontrol('Parent', hFig, ...
    'style', 'pushbutton', ...
    'string', 'OK', ...
    'callback', 'set(gcbf, ''tag'', ''ok'', ''visible'', ''off'');');
hCanc = uicontrol('Parent', hFig, ...
    'style', 'pushbutton', ...
    'string', 'Cancel', ...
    'callback', 'set(gcbf, ''visible'', ''off'');');
hHelp = cghelpbutton(hFig, 'CGSETNOMINALVALUES');

lyt = xreggridbaglayout(hFig, ...
    'packstatus', 'off', ...
    'dimension', [5, 4], ...
    'rowsizes', [60 2 -1 7 25], ...
    'colsizes', [-1 65 65 65], ...
    'border', [7 7 7 7], ...
    'gapx', 7, ...
    'mergeblock', {[1 1], [1 4]}, ...
    'mergeblock', {[3 3], [1 4]}, ...
    'elements', {txt, [], t, [], [], ...
    [], [], [], [], hOK, ...
    [], [], [], [], hCanc, ...
    [], [], [], [], hHelp});
hFig.LayoutManager = lyt;
set(lyt, 'packstatus', 'on');

hFig.showDialog(hOK);

tg = get(hFig, 'tag');
if strcmp(tg, 'ok')
    changed = pChanges.info;
    for n = 1:length(pValues)
        if changed(n)
            pValues(n).info = pValues(n).setnomvalue(t.table.getScalarValue(n));
        end
    end  
else
    changed = false(size(pValues));
end


function i_EditTable(src, evt, pChanges)
row = evt{2};
pChanges.info(row) = true;
