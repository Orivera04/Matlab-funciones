function obj = xregrangeinput(varargin)
%% XREGRANGEINPUT Constructor for the constant control/input object.
%%   Usage:
%%   R=XREGRANGEINPUT
%%   R=XREGRANGEINPUT(FIG)
%%   R=XREGRANGEINPUT('Property1',Value1,...)
%%   R=XREGRANGEINPUT(FIG,'Property1',Value1,...)

%  Copyright 2000-2004 The MathWorks, Inc. and Ford Global Technologies, Inc.


%   $Revision: 1.5.2.2 $  $Date: 2004/02/09 07:32:43 $


%% copy of object in ud of edit(end)
%% other info in ud of 'name' text object

obj.name = [];
obj.text = [];
obj.edit = [];
obj.layout = [];
ud.min = [0];
ud.max = [1];
ud.points = [10];
ud.callback = '';

%% just return copy of object???
%% a trick to get hold of object using last edit box handle
if nargin==2 & ishandle(varargin{1})...
   & strcmp(get(varargin{1},'type'),'uicontrol')...   
   & strcmp(get(varargin{1},'style'),'edit')
   obj = get(varargin{1},'userdata');
   return
end


if nargin>0 & ishandle(varargin{1})...
       & strcmp(get(varargin{1},'type'),'figure')
   fh=varargin{1};
   varargin(1)=[];
else
   fh=gcf;
end

%% default position; set called at end if position input
%% min height = 15, name = 20, other controls = 60
pos = [10 10 200 20];
bgc = get(fh,'color'); % Change from gcf to fh to stop rogue figures being spawned when Handle visibility of fh is off.

%% 60 <= edit <= 120 length for all uicontrols
textH(1) = xreguicontrol('style','text',...
   'visible','off',...
   'parent',fh,...
   'backgroundcolor',bgc,...
   'string','Min:',...
   'horizontalAlignment','right');
textH(2) = xreguicontrol('style','text',...
   'visible','off',...
   'parent',fh,...
   'backgroundcolor',bgc,...
   'string','Max:',...
   'horizontalAlignment','right');
textH(3) = xreguicontrol('style','text',...
   'visible','off',...
   'parent',fh,...
   'backgroundcolor',bgc,...
   'string','Pts:',...
   'horizontalAlignment','right');

editH(1) = xreguicontrol('style','edit',...
   'visible','off',...
   'parent',fh,...
   'backgroundcolor',[1 1 1],...
   'string','0',...
   'horizontalAlignment','left');
editH(2) = xreguicontrol('style','edit',...
   'visible','off',...
   'parent',fh,...
   'backgroundcolor',[1 1 1],...
   'string','1',...
   'horizontalAlignment','left');
editH(3) = xreguicontrol('style','edit',...
   'visible','off',...
   'parent',fh,...
   'backgroundcolor',[1 1 1],...
   'string','10',...
   'horizontalAlignment','left');

nameH = xreguicontrol('style','text',...
   'visible','off',...
   'parent',fh,...
   'string','',...
   'horizontalAlignment','left',...
   'backgroundcolor',bgc);

layout = xreggridbaglayout(fh,...
   'dimension',[2 7],....
   'elements',{[],nameH,...
      [],textH(1),...
      editH(1),[],...
      [],textH(2),...
      editH(2),[],...
      [],textH(3),...
      editH(3),[]},...
   'mergeblock',{[1 2],[3 3]},...
   'mergeblock',{[1 2],[5 5]},...
   'mergeblock',{[1 2],[7 7]},...
   'rowsizes',[-1 17],...
   'colsizes',[-1,23,50,23,50,20,30],...
   'gapx',5,...
   'position',pos);

%% all data fields in ud of 'name' text control
set(nameH,'userdata',ud);

obj.edit = editH;
obj.text = textH;
obj.name = nameH;
obj.layout = layout;
%% class constructor
obj = class(obj,'xregrangeinput');

%% set all callbacks of edit boxes to be the same
builtin('set',editH(1),...
   'callback',['callback(get(' sprintf('%20.15f',editH(3)) ',''userdata''),1);']);
builtin('set',editH(2),...
   'callback',['callback(get(' sprintf('%20.15f',editH(3)) ',''userdata''),2);']);
builtin('set',editH(3),...
   'callback',['callback(get(' sprintf('%20.15f',editH(3)) ',''userdata''),3);']);
%% save copy of object in LAST edit box
builtin('set',editH(3),'userdata',obj);

if length(varargin)
   obj=set(obj,varargin{:});
end
